@using EMSuiteVisualConfigurator.Client.Components;
@using EMSuiteVisualConfigurator.Shared.Models
@using Microsoft.JSInterop
@inject IJSRuntime JS;

@page "/configuration"

<PageTitle>EMSuite Visual Configurator</PageTitle>
<CascadingValue Value="@ImageFile">
<div class="container-fluid">
        <div class="row justify-content-center align-items-center py-2 topbar">
            <TopBarComponent OnUploadImage="UploadImage" />
        </div>
        <div class="row maincontent" >
            <IconMenuComponent>
                <SensorComponent/>
                <AccessPointComponent/>
                <ZoneComponent/>
            </IconMenuComponent>        
            <SiteCanvasComponent/>
        </div>
    </div>
</CascadingValue>


@code {
    private ImageFile ImageFile { get; set; } = new ImageFile();

    private void UploadImage(ImageFile imageFile) {
        ImageFile = imageFile;
        StateHasChanged();
    }

    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        await JS.InvokeVoidAsync("dragstart_handler", ".draggable");
        await JS.InvokeVoidAsync("dragend_handler", ".draggable");
    }
}
